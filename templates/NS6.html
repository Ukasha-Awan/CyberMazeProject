{% extends 'base.html' %}
{% block title %}Capture the Flag{% endblock %}
{% load static %}
{% block content %}

    <h1 style="margin-top: 65px;">Network Traffic Analysis Tools <hr> <br> <span>Packet Analysis part 4</span></h1>
    <p>In this Injector file level, you will step into the analysis of traffic in a network. Your mission is to Extract the Malicious packets from the traffic making a request from an IP. 127.0.0.1. Analyze this section and find out what sort malicious is happening here?.In which packet/frame, what is happening?etc.</p>
  
    <h3>Prerequisites</h3>
    <ul>
        <li>Basic understanding of networking concepts.</li>
        <li>Familiarity with common network protocols (TCP, UDP, HTTP, etc.).</li>
        <li>Wireshark installed on your machine.</li>
    </ul>

    <h3>Tools Used</h3>
    <ul>
        <li><strong>Wireshark</strong> - A widely used network protocol analyzer that allows you to capture and interactively browse traffic on a computer network.</li>
    </ul>

    <div class="download-box">
        <h3>Download the Wireshark File</h3>
        <p>
            Click the button below to download the <strong>Injector.pcap</strong> file:
        </p>
        <a href="{% static 'injector.pcap' %}" download class="download-button">Download</a>
    </div>

    <h3>Analysis File</h3>
    <p>You will analyze the packet capture file named <strong>/Injector.pcap</strong>. This file is located in the same directory as this document.</p>
    <p>Click the link below to download the file:</p>
    <a href="{% static 'injector.pcap' %}" download>Download Injector.pcap</a>

    <h3>Instructions</h3>
    <p>1. Download the <strong>Injector.pcapng</strong> file.</p>
    <p>3. Open the file in Wireshark.</p>
    <p>3. Analyze the packet data to identify key information, such as source and destination IP addresses, protocols used, and any anomalies.</p>
    <p>4. Submit your findings along with any identified flags in the provided form.</p>

    <h3>Task: Your Answer</h3>
    <form id="task1Form">
      <label for="task1Answer">In the Injector file,identify which HTTP frame of network traffic looks suspecious?</label>
      <input type="text" id="task1Answer" name="task1Answer">
      <button type="button" onclick="submitTask1()">Submit</button>
      <span id="task1Result"></span>
    </form>
    <br>
    <h3>Task: Your Answer</h3>
    <form id="task2Form">
      <label for="task2Answer">From frame 4 and 16, apparently what type of attack or security it looks ? </label>
      <input type="text" id="task2Answer" name="task2Answer">
      <button type="button" onclick="submitTask2()">Submit</button>
      <span id="task2Result"></span>
    </form>
    <br>
    <h3>Task: Your Answer</h3>
    <form id="task3Form">
      <label for="task3Answer">In frame 4 , what is the query trying to retrieve from the server?</label>
      <input type="text" id="task3Answer" name="task3Answer">
      <button type="button" onclick="submitTask3()">Submit</button>
      <span id="task3Result"></span>
    </form>
    <br>
    <h3>Task: Your Answer</h3>
    <form id="task4Form">
      <label for="task4Answer">In frame 16 what is the query specifically targeting?</label>
      <input type="text" id="task4Answer" name="task4Answer">
      <button type="button" onclick="submitTask4()">Submit</button>
      <span id="task4Result"></span>
    </form>
    <br>
    <h3>Task: Your Answer</h3>
    <form id="task5Form">
      <label for="task5Answer">After analyzing the Injector.pcapng network traffic file what is the flag related to?</label>
      <input type="text" id="task5Answer" name="task5Answer">
      <button type="button" onclick="submitTask5()">Submit</button>
      <span id="task5Result"></span>
    </form>
    <br>
    

    <div id="mazeCompletion">
        <h3>Level UP!</h3>
        <button style="width: fit-content;"><a href="/levelList3">View Other Levels</a></button>
    </div>
    {%endblock%}

    {% block script %}
        
        function submitTask1() {
            var answer = document.getElementById('task1Answer').value;
            if (answer.toLowerCase() === '4 and 16') {
                document.getElementById('task1Result').textContent = 'Solved';
        updateScore(true); 
            } else {
                document.getElementById('task1Result').textContent = 'Try again';
        updateScore(false); 
            }
            checkMazeCompletion();
        }
        function submitTask2() {
            var answer = document.getElementById('task2Answer').value;
            if (answer.toLowerCase() === 'sql injection') {
                document.getElementById('task2Result').textContent = 'Solved';
        updateScore(true); 
            } else {
                document.getElementById('task2Result').textContent = 'Try again';
        updateScore(false); 
            }
            checkMazeCompletion();
        }
        function submitTask3() {
            var answer = document.getElementById('task3Answer').value;
            if (answer.toLowerCase() === 'name of the database') {
                document.getElementById('task3Result').textContent = 'Solved';
        updateScore(true); 
            } else {
                document.getElementById('task3Result').textContent = 'Try again';
        updateScore(false); 
            }
            checkMazeCompletion();
        }
        function submitTask4() {
            var answer = document.getElementById('task4Answer').value;
            if (answer.toLowerCase() === 'user table') {
                document.getElementById('task4Result').textContent = 'Solved';
        updateScore(true); 
            } else {
                document.getElementById('task4Result').textContent = 'Try again';
        updateScore(false); 
            }
            checkMazeCompletion();
        }
        function submitTask5() {
            var answer = document.getElementById('task5Answer').value;
            if (answer.toLowerCase() === 'security') {
                document.getElementById('task5Result').textContent = 'Solved';
        updateScore(true); 
            } else {
                document.getElementById('task5Result').textContent = 'Try again';
        updateScore(false); 
            }
            checkMazeCompletion();
        }
    
    {% endblock %}
