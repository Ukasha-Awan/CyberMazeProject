{% extends 'base.html' %}
{% block title %}Capture the Flag{% endblock %}
{% load static %}
{% block content %}
    <h1 style="margin-top: 65px;">Network Traffic Analysis Tools <hr> <br> <span>Packet Analysis</span></h1>
    <p>In this exciting level, you will step into the analysis of traffic in a network. Your mission is to analyze the traffic and answer the given questions.what type of packet? what is inside that packet ?Source and destination of that data packet.etc.</p>
    
    <h3>Prerequisites</h3>
    <ul>
        <li>Basic understanding of networking concepts.</li>
        <li>Familiarity with common network protocols (TCP, UDP, HTTP, etc.).</li>
        <li>Wireshark installed on your machine.</li>
    </ul>

    <h3>Tools Used</h3>
    <ul>
        <li><strong>Wireshark</strong> - A widely used network protocol analyzer that allows you to capture and interactively browse traffic on a computer network.</li>
    </ul>

    <div class="download-box">
        <h3>Download the Wireshark File</h3>
        <p>
            Click the button below to download the <strong>Stage 1.pcap</strong> file:
        </p>
        <a href="{% static 'Stage1.pcap' %}" download class="download-button">Download File</a>
    </div>

    <h3>Analysis File</h3>
    <p>You will analyze the packet capture file named <strong>Stage 1.pcapng</strong>. This file is located in the same directory as this document.</p>
    <p>Click the link below to download the file:</p>
    <a href="{% static 'Stage1.pcap' %}" download>Download stage 1.pcapng</a>

    <h3>Instructions</h3>
    <p>1. Download the <strong>stage 1.pcapng</strong> file.</p>
    <p>2. Open the file in Wireshark.</p>
    <p>3. Analyze the packet data to identify key information, such as source and destination IP addresses, protocols used, and any anomalies.</p>
    <p>4. Submit your findings along with any identified flags in the provided form.</p>

    <h3>Task: Your Answer</h3>
    <form id="task1Form">
      <label for="task1Answer">Analyze this file and find out which http packet is containing  flag. Write the flag below:</label>
      <input type="text" id="task1Answer" name="task1Answer">
      <button type="button" onclick="submitTask1()">Submit</button>
      <span id="task1Result"></span>
    </form>
    <br>
    <br>
    
    <div id="mazeCompletion">
        <h3>Level UP!</h3>
        <button style="width: fit-content;"><a href="/levelList3">View Other Levels</a></button>
    </div>
    {%endblock%}

    {% block script %}
        function submitTask1() {
            var answer = document.getElementById('task1Answer').value;
            if (answer.toLowerCase() === 'use_ssl_dude') {
                document.getElementById('task1Result').textContent = 'Solved';
        updateScore(true); 
            } else {
                document.getElementById('task1Result').textContent = 'Try again';
        updateScore(false); 
            }
            checkMazeCompletion();
        }
    
        
    
        function checkMazeCompletion() {
            var task1Solved = document.getElementById('task1Result').dataset.solved === 'true';
    
            if (task1Solved) {
                document.getElementById('mazeCompletion').style.display = 'block';
            }
        }

        {% endblock %}